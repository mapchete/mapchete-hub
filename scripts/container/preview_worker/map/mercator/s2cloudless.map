MAP
  NAME "map"
  IMAGETYPE png
  SIZE 1600 800
  UNITS meters
  DEFRESOLUTION 72
  EXTENT -20037508.3427892 -20037508.3427892 20037508.3427892 20037508.3427892
  CONFIG "MS_ERRORFILE" "stderr"
  IMAGECOLOR "#182c4e"

  CONFIG "AWS_ACCESS_KEY_ID" "REDACTED_API_KEY"
  CONFIG "AWS_SECRET_ACCESS_KEY" "ceeZEwISRbBr5GwcNacG7QmqIJqm5Sj0xZ6uoD1F"
  # Constrain GDAL to read just the tif it is pointed at
  CONFIG "CPL_VSIL_CURL_ALLOWED_EXTENSIONS" ".tif"
  CONFIG "GDAL_DISABLE_READDIR_ON_OPEN" "TRUE"
  # cache size in bytes
  CONFIG "VSI_CACHE" "TRUE"
  CONFIG "VSI_CACHE_SIZE" "50000000"

  OUTPUTFORMAT
    NAME "png"
    DRIVER AGG/PNG
    MIMETYPE "image/png"
    IMAGEMODE RGBA
    EXTENSION "png"
    FORMATOPTION "GAMMA=0.75"
    FORMATOPTION "COMPRESSION=0"
  END
  OUTPUTFORMAT
    NAME "jpeg"
    DRIVER AGG/JPEG
    MIMETYPE "image/jpeg"
    IMAGEMODE RGB
    EXTENSION "jpg"
    FORMATOPTION "GAMMA=0.75"
    FORMATOPTION "QUALITY=90"
  END
  WEB
    METADATA
      OWS_ENABLE_REQUEST "*"
      WMS_SRS "EPSG:3857"
      WMS_EXTENT "-20037508.3427892 -20037508.3427892 20037508.3427892 20037508.3427892"
      WMS_ONLINERESOURCE "http://localhost/"
      LABELCACHE_MAP_EDGE_BUFFER "-10"
      WMS_TITLE "eox_maps_dev"
    END
  END
  PROJECTION
    'init=epsg:3857'
  END

  #######################
  # white land polygons #
  #######################
  LAYER
    NAME ne_land
    STATUS ON
    TYPE POLYGON
    DATA "/mapdata/naturalearth/ne_10m_land"
    PROJECTION
      "init=epsg:4326"
    END
    CLASS
      STYLE
        COLOR "#ffffff"
        OPACITY 100
      END
    END
  END

  ###################
  # cloudless tiles #
  ###################
  LAYER
    NAME rgb_z0
    MINSCALEDENOM 400000000
    STATUS ON
    TYPE RASTER
    TILEINDEX "/indexes/eox-s2cloudless-2018/rgb_corrected_mercator/0.shp"
    TILEITEM "location"
    PROJECTION
      "init=epsg:3857"
    END
  END
  LAYER
    NAME rgb_z1
    MAXSCALEDENOM 400000000
    MINSCALEDENOM 200000000
    STATUS ON
    TYPE RASTER
    TILEINDEX "/indexes/eox-s2cloudless-2018/rgb_corrected_mercator/1.shp"
    TILEITEM "location"
    PROJECTION
      "init=epsg:3857"
    END
  END
  LAYER
    NAME rgb_z2
    MAXSCALEDENOM 200000000
    MINSCALEDENOM 100000000
    STATUS ON
    TYPE RASTER
    TILEINDEX "/indexes/eox-s2cloudless-2018/rgb_corrected_mercator/2.shp"
    TILEITEM "location"
    PROJECTION
      "init=epsg:3857"
    END
  END
  LAYER
    NAME rgb_z3
    MAXSCALEDENOM 100000000
    MINSCALEDENOM 50000000
    STATUS ON
    TYPE RASTER
    TILEINDEX "/indexes/eox-s2cloudless-2018/rgb_corrected_mercator/3.shp"
    TILEITEM "location"
    PROJECTION
      "init=epsg:3857"
    END
  END
  LAYER
    NAME rgb_z4
    MAXSCALEDENOM 50000000
    MINSCALEDENOM 25000000
    STATUS ON
    TYPE RASTER
    TILEINDEX "/indexes/eox-s2cloudless-2018/rgb_corrected_mercator/4.shp"
    TILEITEM "location"
    PROJECTION
      "init=epsg:3857"
    END
  END
  LAYER
    NAME rgb_z5
    MAXSCALEDENOM 25000000
    MINSCALEDENOM 12500000
    STATUS ON
    TYPE RASTER
    TILEINDEX "/indexes/eox-s2cloudless-2018/rgb_corrected_mercator/5.shp"
    TILEITEM "location"
    PROJECTION
      "init=epsg:3857"
    END
  END
  LAYER
    NAME rgb_z6
    MAXSCALEDENOM 12500000
    MINSCALEDENOM 6500000
    STATUS ON
    TYPE RASTER
    TILEINDEX "/indexes/eox-s2cloudless-2018/rgb_corrected_mercator/6.shp"
    TILEITEM "location"
    OFFSITE 0 0 0
    PROJECTION
      "init=epsg:3857"
    END
  END
  LAYER
    NAME rgb_z7
    MAXSCALEDENOM 6500000
    MINSCALEDENOM 3000000
    STATUS ON
    TYPE RASTER
    TILEINDEX "/indexes/eox-s2cloudless-2018/rgb_corrected_mercator/7.shp"
    TILEITEM "location"
    PROJECTION
      "init=epsg:3857"
    END
  END
  LAYER
    NAME rgb_z8
    MAXSCALEDENOM 3000000
    MINSCALEDENOM 1500000
    STATUS ON
    TYPE RASTER
    TILEINDEX "/indexes/eox-s2cloudless-2018/rgb_corrected_mercator/8.shp"
    TILEITEM "location"
    PROJECTION
      "init=epsg:3857"
    END
  END
  LAYER
    NAME rgb_z9
    MAXSCALEDENOM 1500000
    MINSCALEDENOM 750000
    STATUS ON
    TYPE RASTER
    TILEINDEX "/indexes/eox-s2cloudless-2018/rgb_corrected_mercator/9.shp"
    TILEITEM "location"
    PROJECTION
      "init=epsg:3857"
    END
  END
  LAYER
    NAME rgb_z10
    MAXSCALEDENOM 750000
    MINSCALEDENOM 400000
    STATUS ON
    TYPE RASTER
    TILEINDEX "/indexes/eox-s2cloudless-2018/rgb_corrected_mercator/10.shp"
    TILEITEM "location"
    PROJECTION
      "init=epsg:3857"
    END
  END
  LAYER
    NAME rgb_z11
    MAXSCALEDENOM 400000
    MINSCALEDENOM 200000
    STATUS ON
    TYPE RASTER
    TILEINDEX "/indexes/eox-s2cloudless-2018/rgb_corrected_mercator/11.shp"
    TILEITEM "location"
    PROJECTION
      "init=epsg:3857"
    END
  END
  LAYER
    NAME rgb_z12
    MAXSCALEDENOM 200000
    MINSCALEDENOM 100000
    STATUS ON
    TYPE RASTER
    TILEINDEX "/indexes/eox-s2cloudless-2018/rgb_corrected_mercator/12.shp"
    TILEITEM "location"
    PROJECTION
      "init=epsg:3857"
    END
  END
  LAYER
    NAME rgb_z13
    MAXSCALEDENOM 100000
    MINSCALEDENOM 50000
    STATUS ON
    TYPE RASTER
    TILEINDEX "/indexes/eox-s2cloudless-2018/rgb_corrected_mercator/13.shp"
    TILEITEM "location"
    PROJECTION
      "init=epsg:3857"
    END
  END
  LAYER
    NAME rgb_z14
    MAXSCALEDENOM 50000
    STATUS ON
    TYPE RASTER
    TILEINDEX "/indexes/eox-s2cloudless-2018/rgb_corrected_mercator/14.shp"
    TILEITEM "location"
    PROJECTION
      "init=epsg:3857"
    END
    PROCESSING "RESAMPLE=BILINEAR"
  END

  ##############
  # ocean mask #
  ##############

  LAYER
    NAME mercator/mask_fade_z1
    MINSCALEDENOM 200000000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/mask_fade/mercator/1.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    PROCESSING "BANDS=1,2,3,4"
  END
  LAYER
    NAME mercator/mask_fade_z2
    MAXSCALEDENOM 200000000
    MINSCALEDENOM 100000000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/mask_fade/mercator/2.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    PROCESSING "BANDS=1,2,3,4"
  END
  LAYER
    NAME mercator/mask_fade_z3
    MAXSCALEDENOM 100000000
    MINSCALEDENOM 50000000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/mask_fade/mercator/3.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    PROCESSING "BANDS=1,2,3,4"
  END
  LAYER
    NAME mercator/mask_fade_z4
    MAXSCALEDENOM 50000000
    MINSCALEDENOM 25000000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/mask_fade/mercator/4.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    PROCESSING "BANDS=1,2,3,4"
  END
  LAYER
    NAME mercator/mask_fade_z5
    MAXSCALEDENOM 25000000
    MINSCALEDENOM 12500000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/mask_fade/mercator/5.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    PROCESSING "BANDS=1,2,3,4"
  END
  LAYER
    NAME mercator/mask_fade_z6
    MAXSCALEDENOM 12500000
    MINSCALEDENOM 6500000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/mask_fade/mercator/6.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    PROCESSING "BANDS=1,2,3,4"
  END
  LAYER
    NAME mercator/mask_fade_z7
    MAXSCALEDENOM 6500000
    MINSCALEDENOM 3000000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/mask_fade/mercator/7.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    PROCESSING "BANDS=1,2,3,4"
  END
  LAYER
    NAME mercator/mask_fade_z8
    MAXSCALEDENOM 3000000
    MINSCALEDENOM 1500000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/mask_fade/mercator/8.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    PROCESSING "BANDS=1,2,3,4"
  END
  LAYER
    NAME mercator/mask_fade_z9
    MAXSCALEDENOM 1500000
    # until zoom 11
    MINSCALEDENOM 187500
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/mask_fade/mercator/9.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    PROCESSING "BANDS=1,2,3,4"
  END

  ###############
  # ocean depth #
  ###############
  LAYER
    NAME depth_z1
    MINSCALEDENOM 200000000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/cleantopo_depth/mercator/1.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    COMPOSITE
      COMPOP "multiply"
      OPACITY 80
    END
  END
  LAYER
    NAME depth_z2
    MAXSCALEDENOM 200000000
    MINSCALEDENOM 100000000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/cleantopo_depth/mercator/2.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    COMPOSITE
      COMPOP "multiply"
      OPACITY 80
    END
  END
  LAYER
    NAME depth_z3
    MAXSCALEDENOM 100000000
    MINSCALEDENOM 50000000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/cleantopo_depth/mercator/3.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    COMPOSITE
      COMPOP "multiply"
      OPACITY 80
    END
  END
  LAYER
    NAME depth_z4
    MAXSCALEDENOM 50000000
    MINSCALEDENOM 25000000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/cleantopo_depth/mercator/4.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    COMPOSITE
      COMPOP "multiply"
      OPACITY 80
    END
  END
  LAYER
    NAME depth_z5
    MAXSCALEDENOM 25000000
    MINSCALEDENOM 12500000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/cleantopo_depth/mercator/5.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    COMPOSITE
      COMPOP "multiply"
      OPACITY 80
    END
  END
  LAYER
    NAME depth_z6
    MAXSCALEDENOM 12500000
    MINSCALEDENOM 6500000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/cleantopo_depth/mercator/6.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    COMPOSITE
      COMPOP "multiply"
      OPACITY 80
    END
  END
  LAYER
    NAME depth_z7
    MAXSCALEDENOM 6500000
    MINSCALEDENOM 3000000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/cleantopo_depth/mercator/7.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    COMPOSITE
      COMPOP "multiply"
      OPACITY 80
    END
  END
  LAYER
    NAME depth_z8
    MAXSCALEDENOM 3000000
    MINSCALEDENOM 1500000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/cleantopo_depth/mercator/8.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    COMPOSITE
      COMPOP "multiply"
      OPACITY 80
    END
  END

  ##############
  # bathymetry #
  ##############
  LAYER
    NAME mercator/bathymetry_z1
    MINSCALEDENOM 200000000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/bathymetry/mercator/1.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    COMPOSITE
      OPACITY 80
      COMPOP "multiply"
    END
  END
  LAYER
    NAME mercator/bathymetry_z2
    MAXSCALEDENOM 200000000
    MINSCALEDENOM 100000000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/bathymetry/mercator/2.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    COMPOSITE
      OPACITY 80
      COMPOP "multiply"
    END
  END
  LAYER
    NAME mercator/bathymetry_z3
    MAXSCALEDENOM 100000000
    MINSCALEDENOM 50000000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/bathymetry/mercator/3.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    COMPOSITE
      OPACITY 80
      COMPOP "multiply"
    END
  END
  LAYER
    NAME mercator/bathymetry_z4
    MAXSCALEDENOM 50000000
    MINSCALEDENOM 25000000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/bathymetry/mercator/4.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    COMPOSITE
      compop "multiply"
      OPACITY 100
    END
  END
  LAYER
    NAME mercator/bathymetry_z5
    MAXSCALEDENOM 25000000
    MINSCALEDENOM 12500000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/bathymetry/mercator/5.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    COMPOSITE
      OPACITY 80
      COMPOP "multiply"
    END
  END
  LAYER
    NAME mercator/bathymetry_z6
    MAXSCALEDENOM 12500000
    MINSCALEDENOM 6500000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/bathymetry/mercator/6.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    COMPOSITE
      OPACITY 80
      COMPOP "multiply"
    END
  END
  LAYER
    NAME mercator/bathymetry_z7
    MAXSCALEDENOM 6500000
    MINSCALEDENOM 3000000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/bathymetry/mercator/7.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    COMPOSITE
      OPACITY 80
      COMPOP "multiply"
    END
  END
  LAYER
    NAME mercator/bathymetry_z8
    MAXSCALEDENOM 3000000
    MINSCALEDENOM 1500000
    STATUS ON
    TYPE RASTER
    DATA "/mapdata/bathymetry/mercator/8.vrt"
    PROJECTION
      "init=epsg:3857"
    END
    COMPOSITE
      OPACITY 80
      COMPOP "multiply"
    END
  END

END
